{"version":3,"file":"commonHelpers.js","sources":["../src/js/image-search.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\n\n\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    const form = document.getElementById('searchForm')\n    const input = document.getElementById('searchQuery')\n    const resultDiv = document.getElementById('results')\n    const loader = document.getElementById('loader');\n    const loadMoreBtn = document.getElementById('loadMoreBtn')\n\n    let currentPage = 1;\n    let currentQuery = '';\n    let totalHits = 40;\n\n    loadMoreBtn.style.display = 'none';\n\n    form.addEventListener('submit', (evt) => {\n        evt.preventDefault();\n\n        currentQuery = input.value;\n        currentPage = 1;\n        resultDiv.innerHTML = '';\n        loadMoreBtn.style.display = 'inline-block';\n        fetchImages(currentQuery, currentPage)\n    });\n    \n    loadMoreBtn.addEventListener('click', async () => {\n        currentPage++;\n        await fetchImages(currentQuery, currentPage);\n        const firstCard = document.querySelector('.image-card');\n        if (firstCard) {\n            const cardHeight = firstCard.getBoundingClientRect().height;\n            window.scrollBy({\n                top: cardHeight * 4,\n                behavior: 'smooth'\n            });\n        }\n    });\n\n    async function fetchImages(query, page) {\n        const searchParams = new URLSearchParams({\n            key: '44808922-f3ebf9148f40a6c297279d5b7',\n            q: query,\n            image_type: 'photo',\n            orientation: 'horizontal',\n            safesearch: 'true',\n            page: page,\n            per_page: 20\n        });\n\n\n        const url = `https://pixabay.com/api/?${searchParams}`;\n        loader.style.display = 'block';\n\n        try {\n            const response = await axios.get(url);\n            const data = response.data;\n            returnResult(data);\n        } catch (error) {\n            console.log('Error:', error);\n        } finally {\n            loader.style.display = 'none';\n        }\n    }\n    \n    function returnResult(data) {\n        if(data.hits.length > 0) {\n            data.hits.forEach(hit => {\n                const card = document.createElement('div');\n                card.className = 'image-card';\n                card.innerHTML = \n                    `<a href=\"${hit.largeImageURL}\" class=\"gallery-item\">\n                        <img src=\"${hit.webformatURL}\" alt=\"${hit.tags}\">\n                    </a>\n                    <div class=\"info\">\n                        <div><p>Likes</p><span>${hit.likes}</span></div>\n                        <div><p>Views</p><span>${hit.views}</span></div>\n                        <div><p>Comments</p><span>${hit.comments}</span></div>\n                        <div><p>Downloads</p><span>${hit.downloads}</span></div>\n                    </div>`;\n                resultDiv.appendChild(card);\n            });\n\n            const lightbox = new SimpleLightbox('.gallery-item', {});\n                lightbox.refresh();\n\n            if (data.hits.length < 20) {\n                loadMoreBtn.style.display = 'none';\n            } else if (resultDiv.children.length >= totalHits) {\n                loadMoreBtn.style.display = 'none';\n                iziToast.info({\n                    message: \"We're sorry, but you've reached the end of search results.\",\n                    progressBarColor: '#808080',\n                    displayMode: 'replace',\n                    position: 'topRight',\n                    zindex: '999',\n                    closeOnClick: 'true'\n                });\n            } else {\n                loadMoreBtn.style.display = 'block';\n            }\n        } else {\n            iziToast.error({\n                message: `Sorry, there are no images matching<br> your search query. Please try again!`,\n                progressBarColor: '#808080',\n                displayMode: 'replace',\n                position: 'topRight',\n                zindex: '999',\n                closeOnClick: 'true'\n            });\n        }\n    }\n})"],"names":["form","input","resultDiv","loader","loadMoreBtn","currentPage","currentQuery","totalHits","evt","fetchImages","firstCard","cardHeight","query","page","url","data","axios","returnResult","error","hit","card","SimpleLightbox","iziToast"],"mappings":"kHAQA,SAAS,iBAAiB,mBAAoB,UAAW,CACrD,MAAMA,EAAO,SAAS,eAAe,YAAY,EAC3CC,EAAQ,SAAS,eAAe,aAAa,EAC7CC,EAAY,SAAS,eAAe,SAAS,EAC7CC,EAAS,SAAS,eAAe,QAAQ,EACzCC,EAAc,SAAS,eAAe,aAAa,EAEzD,IAAIC,EAAc,EACdC,EAAe,GACfC,EAAY,GAEhBH,EAAY,MAAM,QAAU,OAE5BJ,EAAK,iBAAiB,SAAWQ,GAAQ,CACrCA,EAAI,eAAc,EAElBF,EAAeL,EAAM,MACrBI,EAAc,EACdH,EAAU,UAAY,GACtBE,EAAY,MAAM,QAAU,eAC5BK,EAAYH,EAAcD,CAAW,CAC7C,CAAK,EAEDD,EAAY,iBAAiB,QAAS,SAAY,CAC9CC,IACA,MAAMI,EAAYH,EAAcD,CAAW,EAC3C,MAAMK,EAAY,SAAS,cAAc,aAAa,EACtD,GAAIA,EAAW,CACX,MAAMC,EAAaD,EAAU,sBAAqB,EAAG,OACrD,OAAO,SAAS,CACZ,IAAKC,EAAa,EAClB,SAAU,QAC1B,CAAa,CACJ,CACT,CAAK,EAED,eAAeF,EAAYG,EAAOC,EAAM,CAYpC,MAAMC,EAAM,4BAXS,IAAI,gBAAgB,CACrC,IAAK,qCACL,EAAGF,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,KAAMC,EACN,SAAU,EACtB,CAAS,CAGmD,GACpDV,EAAO,MAAM,QAAU,QAEvB,GAAI,CAEA,MAAMY,GADW,MAAMC,EAAM,IAAIF,CAAG,GACd,KACtBG,EAAaF,CAAI,CACpB,OAAQG,EAAO,CACZ,QAAQ,IAAI,SAAUA,CAAK,CACvC,QAAkB,CACNf,EAAO,MAAM,QAAU,MAC1B,CACJ,CAED,SAASc,EAAaF,EAAM,CACrBA,EAAK,KAAK,OAAS,GAClBA,EAAK,KAAK,QAAQI,GAAO,CACrB,MAAMC,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,UAAY,aACjBA,EAAK,UACD,YAAYD,EAAI,aAAa;AAAA,oCACbA,EAAI,YAAY,UAAUA,EAAI,IAAI;AAAA;AAAA;AAAA,iDAGrBA,EAAI,KAAK;AAAA,iDACTA,EAAI,KAAK;AAAA,oDACNA,EAAI,QAAQ;AAAA,qDACXA,EAAI,SAAS;AAAA,4BAElDjB,EAAU,YAAYkB,CAAI,CAC1C,CAAa,EAEgB,IAAIC,EAAe,gBAAiB,CAAE,CAAA,EAC1C,QAAO,EAEhBN,EAAK,KAAK,OAAS,GACnBX,EAAY,MAAM,QAAU,OACrBF,EAAU,SAAS,QAAUK,GACpCH,EAAY,MAAM,QAAU,OAC5BkB,EAAS,KAAK,CACV,QAAS,6DACT,iBAAkB,UAClB,YAAa,UACb,SAAU,WACV,OAAQ,MACR,aAAc,MAClC,CAAiB,GAEDlB,EAAY,MAAM,QAAU,SAGhCkB,EAAS,MAAM,CACX,QAAS,+EACT,iBAAkB,UAClB,YAAa,UACb,SAAU,WACV,OAAQ,MACR,aAAc,MAC9B,CAAa,CAER,CACL,CAAC"}